var login_container_showed = false;
var notifications_container_showed = false;
var footer_container_showed = false;
var combo_hidden = true;
var IROUTE = window.location.protocol + "//" + window.location.hostname;
var timeOutOne;
var slider_selected;

$.preloadImages = function()
{
    for(var i = 0; i < arguments.length; i++)
    {
        $("<img />").attr("src", arguments[i]);
    }
}

function AJAXCrearObjeto(){
	var obj;   
	if(window.XMLHttpRequest) { // no es IE
		obj = new XMLHttpRequest();
		
	} else { // Es IE o no tiene el objeto
		try {
			obj = new ActiveXObject('Microsoft.XMLHTTP');
		}  catch (e) {
			alert('El navegador utilizado no est? soportado');
		}
	}
	
	return obj;
}

function isURLValid(url) {
    var regex=/^(ht|f)tps?:\/\/\w+([\.\-\w]+)?\.([a-z]{2,4}|travel)(:\d{2,5})?(\/.*)?$/i;
    return regex.test(url);
}

function checkUserLogged(){

    var result = true;

    if(!USER_LOGGED){

       /* $('#login-required-popup').lightbox_me({
            centered: true,
            closeSelector: '#close-login-required-popup'
        });*/
		
			hideAllTopBarSliders();
            login_container_showed = true;
			document.getElementById("message_not_logged_in_action").style.display="block";
			$('#register_form').lightbox_me({
					centered: true,
					closeSelector: '#close-register_form-required-popup',
                    onClose: function(){
                        $('.register-form-error').hide();
                    }
				});		

        result = false;
    }

    return result;
}

function processTinyMCEKeyUpEvent(){

    var txt = tinyMCE.activeEditor.getContent();
	
	
	
    //strip the html
    txt = txt.replace(/(<([^>]+)>)/ig,"");//Remueve los tags
    //txt = txt.replace(/ /g,\"\");//Remueve los espacios
    txt = txt.replace(/\n/gi,"");//Remueve los saltos de linea
    txt = $("<div/>").html(txt).text();

    $('#chars-count').text(txt.length);

    if((txt.length < 1000) || (txt.length > 3000)){
        $('#chars-count').attr('class', 'insufficient-chars-count');
        $('#publish-button').attr('disabled', true);
    }
    else{
        $('#chars-count').attr('class', 'enough-chars-count');
        $('#publish-button').attr('disabled', false);
    }


}


function processClapEvent(text_id, writer_id, clap_container){

    var result = checkUserLogged();

    if(result){
        $.post(
            clap_url,
            {
                text_id: text_id,
                writer_id: writer_id
            },
            function(data) {
                result = data.success;
                if(result){
                    $(clap_container).text(APPLAUDED);
                    $(clap_container).attr('class', 'applauded');
                }
            }
            , "json"
        );

    }

    return result;

}

function processAddFavoritesEvent(text_id, fav_container){

    if(USER_LOGGED){

        $.post(
            add_to_favorites_url,
            { text_id: text_id },
            function(data) {

                if(data.success){

                    $(fav_container).attr('id', 'no-favorite-icon');
                    $(fav_container).attr('title', UNDO_ADD_TO_FAVORITES);

                }

            }
            , "json"
        );

    }
    else{
        $('#login-required-popup').lightbox_me({
            centered: true,
            closeSelector: '#close-login-required-popup'
        });
    }


}

function processAddFavoritesEvent2(text_id){

    var result = checkUserLogged();

    if(result){

        $.post(
            add_to_favorites_url,
            { text_id: text_id },
            function(data) {

                result = data.success;

            }
            , "json"
        );

    }

    return result;
}

function processUndoAddFavoritesEvent(text_id, fav_container){

    if(USER_LOGGED){

        $.post(
            undo_add_to_favorites_url,
            { text_id: text_id },
            function(data) {

                if(data.success){

                    $(fav_container).attr('id', 'favorite-icon');
                    $(fav_container).attr('title', ADD_TO_FAVORITES);

                }

            }
            , "json"
        );

    }
    else{
        $('#login-required-popup').lightbox_me({
            centered: true,
            closeSelector: '#close-login-required-popup'
        });
    }


}

function processUndoAddFavoritesEvent2(text_id){

    var result = checkUserLogged();

    if(result){

        $.post(
            undo_add_to_favorites_url,
            { text_id: text_id },
            function(data) {

                result = data.success;

            }
            , "json"
        );

    }

    return result;
}

function processSaveEvent(text_id, save_box_id, unarchive_button_id){

    if(USER_LOGGED){

        $.post(
            add_to_saved_url,
            { text_id: text_id },
            function(data) {

                if(data.success){
                    html = "<button id='"+unarchive_button_id+"'>"+UNARCHIVE+"</button>";
                    $('#'+save_box_id).html(html);
                }

            }
            , "json"
        );

    }
    else{
        $('#login-required-popup').lightbox_me({
            centered: true,
            closeSelector: '#close-login-required-popup'
        });
    }


}

function processSaveEvent2(text_id){

    var result = checkUserLogged();

    if(result){

        $.post(
            add_to_saved_url,
            { text_id: text_id },
            function(data) {

                result = data.success

            }
            , "json"
        );

    }

    return result;
}

function processUnarchiveEvent(text_id, save_box_id, save_button_id){

    if(USER_LOGGED){

        $.post(
            unarchive_url,
            { text_id: text_id },
            function(data) {

                if(data.success){
                    html = "<button id='"+save_button_id+"'>"+SAVE+"</button>";
                    $('#'+save_box_id).html(html);
                }

            }
            , "json"
        );

    }
    else{
        $('#login-required-popup').lightbox_me({
            centered: true,
            closeSelector: '#close-login-required-popup'
        });
    }


}

function processUnarchiveEvent2(text_id){

    var result = checkUserLogged();

    if(result){

        $.post(
            unarchive_url,
            { text_id: text_id },
            function(data) {

                result = data.success;

            }
            , "json"
        );

    }

    return result;

}

function processDenounceEvent(text_id, denounce_box_id){

    if(USER_LOGGED){

        $.post(
            denounce_url,
            { text_id: text_id },
            function(data) {

                if(data.success){
                    html = '<span id="denounced">'+YOU_ALREADY_REPORTED_THIS_TEXT+'</span>';
                    $('#'+denounce_box_id).html(html);
                }

            }
            , "json"
        );

    }
    else{
        $('#login-required-popup').lightbox_me({
            centered: true,
            closeSelector: '#close-login-required-popup'
        });
    }


}


function processFollowEvent(writer_id, follow_box_id, unfollow_button_id){

    if(USER_LOGGED){

        $.post(
            follow_url,
            { writer_id: writer_id },
            function(data) {

                if(data.success){
                    html = "<button id='"+unfollow_button_id+"'>"+UNFOLLOW+"</button>";
                    $('#'+follow_box_id).html(html);
                }

            }
            , "json"
        );

    }
    else{
        $('#login-required-popup').lightbox_me({
            centered: true,
            closeSelector: '#close-login-required-popup'
        });
    }


}

function processUnfollowEvent(writer_id, follow_box_id, follow_button_id){

    if(USER_LOGGED){

        $.post(
            unfollow_url,
            { writer_id: writer_id },
            function(data) {

                if(data.success){
                    html = "<button id='"+follow_button_id+"'>"+FOLLOW+"</button>";
                    $('#'+follow_box_id).html(html);
                }

            }
            , "json"
        );

    }
    else{
        $('#login-required-popup').lightbox_me({
            centered: true,
            closeSelector: '#close-login-required-popup'
        });
    }


}


function processSendMessageEvent(user_to, subject, message, send_button_box, loading_div_id, popup_div_id, subject_field_id, message_field_id){

    if(USER_LOGGED){

        var errors = new Array();

        if(subject == ""){
            errors.push(FIELD_IS_REQUIRED.replace("{field}", SUBJECT));
        }

        if(message == ""){
            errors.push(FIELD_IS_REQUIRED.replace("{field}", MESSAGE));
        }

        if(errors.length == 0){

            var html_aux = $('#'+send_button_box).html();
            $('#'+send_button_box).html($('#'+loading_div_id).html());

            $.post(
                send_message_url,
                {
                    user_to: user_to,
                    subject: subject,
                    message: message
                },
                function(data) {

                    if(data.success){

                        $('#'+loading_div_id).hide();
                        $('#'+send_button_box).html(html_aux);
                        $('#'+popup_div_id).trigger('close');
                        $('#'+subject_field_id).val('');
                        $('#'+message_field_id).val('');

                    }
                    else{

                        $('#'+send_button_box).html(html_aux);
                    }

                }
                , "json"
            );

        }
        else{

            var errorMsg = errors.join('\n');
            alert(errorMsg);

        }

    }
    else{
        $('#login-required-popup').lightbox_me({
            centered: true,
            closeSelector: '#close-login-required-popup'
        });
    }

}

function processSendMessageEvent2(user_to, message){

    if(USER_LOGGED){

        //var errors = new Array();
        message = $.trim(message);

        /*if(message == ""){
            errors.push(FIELD_IS_REQUIRED.replace("{field}", MESSAGE));
        }*/

        if(message != ""){

            $('#message-popup-send-button').addClass('disabled');

            $.post(
                send_message2_url,
                {
                    user_to: user_to,
                    message: message
                },
                function(data) {

                    if(data.success){

                        $('#message-send-popup-container').trigger('close');
                        $('#message-sent-popup-container').lightbox_me({
                            centered: true,
                            closeSelector: '.message-popup-cancel'
                        });

                    }

                }
                , "json"
            ).done(function(){
                $('#message-popup-send-button').removeClass('disabled');
            }).fail(function(){
                $('#message-popup-send-button').removeClass('disabled');
            });

        }
        else{
            $('#message-popup-msg').addClass('write-invalid');
            $('#message-popup-msg').val('');
            $('#message-popup-msg').focus();
            //var errorMsg = errors.join('\n');
            //alert(errorMsg);

        }

    }
    else{
        $('#login-required-popup').lightbox_me({
            centered: true,
            closeSelector: '#close-login-required-popup'
        });
    }

}

function hideAllTopBarSliders(){

    $('#footer-container').slideUp('fast');
    footer_container_showed = false;

    if(slider_selected != "login"){
        $('#login-container').slideUp('fast');
        login_container_showed = false;
    }

    //$('#notifications-container').slideUp('fast');
    $('#notifications-container').hide();
    notifications_container_showed = false;

}

$(document).ready(function(){

    $('body').click(function(){
        $('.select-arrow').removeClass('arrow-up');
        $('.select-arrow').addClass('arrow-down');
        $('.select-items').slideUp(300);
    });

    $('.select-current').click(function(e){

        e.stopPropagation();

        if($(this).children('.select-arrow').hasClass('arrow-down')){
            $(this).children('.select-arrow').removeClass('arrow-down');
            $(this).children('.select-arrow').addClass('arrow-up');
            $(this).children('.select-items').slideDown(300);
        }
        else{
            $(this).children('.select-arrow').removeClass('arrow-up');
            $(this).children('.select-arrow').addClass('arrow-down');
            $(this).children('.select-items').slideUp(300);
        }
    });

    $('.select-item').click(function(e){

        e.stopPropagation();

        var value = $(this).data('value');
        var text = $(this).text();

        var select_current = $(this).parents('.select-current');
        var select_text = $(select_current).children('.select-text');
        $(select_text).text(text);
        $(select_current).children('input[type="hidden"]').val(value);
        $(select_current).children('.select-arrow').removeClass('arrow-up');
        $(select_current).children('.select-arrow').addClass('arrow-down');
        $(select_current).children('.select-items').slideUp(300);

    });

    $('.edit-profile-cancel').click(function(){
        window.location = profile_url;
    });


    $('#write-link').click(function(event){

        if(!USER_LOGGED){

            event.preventDefault();
            document.getElementById("message_not_logged_in_action").style.display="block";
            $('#register_form').lightbox_me({
                centered: true,
                closeSelector: '#close-register_form-required-popup',
                onClose: function(){
                    $('.register-form-error').hide();
                }
            });
        }

    });

    $('#preview-button').click(function(){

        var category_color = $("#category-select-current").data('categoryColorCode');
        $('#preview-popup-category-color').css('background', '#'+category_color);
        $('#preview-popup-text-category').css('color', '#'+category_color);

        $('#preview-popup-text-category').html($("#category-select-current").data('categoryTitle'));
        $('#preview-popup-text-title').html($('#jform_title').val());
        $('#preview-popup-text-author').html(BY+" "+NAME);
        //$('#preview-popup-text-content').html(tinyMCE.activeEditor.getContent());
        $('#preview-popup-text-content').html($('#text-editor').val());
        var tags_string = "";
        var tags = new Array();
        $('.tag-name').each(function() {
            tags.push($(this).text());
        });
        tags_string += tags.join(', ');
        $('#preview-popup-text-tags').html(tags_string);

        $("#preview-popup").lightbox_me({
                closeSelector: "#back-to-edit-button",
                /*centered: true,*/
                lightboxSpeed: 'slow',
                onLoad: function(){
                    //alert($('#preview-popup').height());
                    //$('#contentarea').height(($(this).height()+100)+'px');
                },
                onClose: function(){
                    //alert('onclose')
                }
            });

    });

    /*$('#login-link-container').click(function(event){

        if(login_container_showed){
            $('#login-container').slideUp('slow');
            login_container_showed = false;
        }
        else{
            hideAllTopBarSliders();
            $('#login-container').slideDown('slow');
            login_container_showed = true;
        }
        event.stopPropagation();
        event.preventDefault();
    });*/

    $('#login-link-container').click(function(){
        if(USER_LOGGED){
            window.location = my_profile_url;
        }
    });

    $('#profile-slider-logout').click(function(event){
        event.preventDefault();
        $('#logout-submit-button').click();
    });

    $('#login-link-wrapper').hover(
        function(){
            clearTimeout(timeOutOne);
            slider_selected = "login";

			if (errorlogin==false){
				hideAllTopBarSliders();
			}
            //$('#login-container').slideDown('slow');
			document.getElementById("login-container").style.display="block";
        },
        function(){
            //$('#login-container').slideUp('slow');
            clearTimeout(timeOutOne);

            timeOutOne = setTimeout(function(){
                    document.getElementById("login-container").style.display="none";
                    slider_selected = "";
                }
                ,1000
            );

        }
    );

	
	 $('#forgot_password_buttton').click(function(event){
		if(!USER_LOGGED){
		  hideAllTopBarSliders();
            $('#login-container').slideDown('slow');
            login_container_showed = true;
			$('#forgot-password').lightbox_me({
					centered: true,
					closeSelector: '#close-forgot-pass-required-popup'
				});
			}
	});
	$('#forgot_username_buttton').click(function(event){
		if(!USER_LOGGED){
		  hideAllTopBarSliders();
            $('#login-container').slideDown('slow');
            login_container_showed = true;
			$('#forgot-username').lightbox_me({
					centered: true,
					closeSelector: '#close-forgot-username-required-popup'
				});
			}
	});

	$('#registersite_link').click(function(event){
		if(!USER_LOGGED){
			hideAllTopBarSliders();
            login_container_showed = true;
			document.getElementById("message_not_logged_in_action").style.display="none";
			$('#register_form').lightbox_me({
					centered: true,
					closeSelector: '#close-register_form-required-popup',
                    onClose: function(){
                        $('.register-form-error').hide();
                    }
				});
			}
	});
	
	
	
	
    $('body').not('#login-container').click(function(event){
        event.stopPropagation();

        var $target = $(event.target);
        if(!($target.is("#login-container")) && !($target.is("#login-container *"))){

            if(login_container_showed){
                $('#login-container').slideUp('slow');
                login_container_showed = false;
            }

        }


    });


    $('#notifications-icon').click(function(event){

        if(notifications_container_showed){
            //$('#notifications-container').slideUp('slow');
            $('#notifications-container').hide();
            notifications_container_showed = false;
        }
        else{

            if(amount_notifications > 0){

                $.post(
                    set_saw_all_notifications,
                    {},
                    function(data) {

                        if(data.success){

                            amount_notifications = 0;

                        }

                    }
                    , "json"
                );

            }
            amount_notifications = 0;
            hideAllTopBarSliders();
            $('#notifications-red-box').html(amount_notifications);
            $('#notifications-red-box').fadeOut('slow');
            //$('#notifications-container').slideDown('slow');
            $('#notifications-container').show();
            notifications_container_showed = true;
        }
        event.stopPropagation();
        event.preventDefault();
    });

    $('body').not('#notifications-container').click(function(event){
        event.stopPropagation();

        var $target = $(event.target);
        if(!($target.is("#notifications-container")) && !($target.is("#notifications-container *"))){

            if(notifications_container_showed){
                $('#notifications-container').slideUp('slow');
                notifications_container_showed = false;
            }

        }
    });


    $('#footer-link').click(function(event){

        if(footer_container_showed){
            $('#footer-container').slideUp('slow');
            footer_container_showed = false;
        }
        else{
            hideAllTopBarSliders();
            $('#footer-container').slideDown('slow');
            footer_container_showed = true;
        }
        event.stopPropagation();
        event.preventDefault();
    });

    $('body').not('#footer-container').click(function(event){
        event.stopPropagation();

        var $target = $(event.target);
        if(!($target.is("#footer-container")) && !($target.is("#footer-container *"))){

            if(footer_container_showed){
                $('#footer-container').slideUp('slow');
                footer_container_showed = false;
            }

        }


    });

    $('#filters').click(function(){
        if(combo_hidden){
            $('#combos').show('slow');
            $('#filter-arrow').addClass('filter-left-arrow');
            $('#filter-arrow').removeClass('filter-right-arrow');
        }
        else{
            $('#combos').hide('slow');
            $('#filter-arrow').addClass('filter-right-arrow');
            $('#filter-arrow').removeClass('filter-left-arrow');
        }
        combo_hidden = !combo_hidden;
    });

    $('.combo').change(function(){

        $("#text-filters-form").submit();

    });

    $('#magnifying-glass').click(function(){

        $("#text-filters-form").submit();

    });

    $('#text-search-input').focus(function(){
        if($(this).val() == SEARCH){
            $(this).val('');
        }
    });

    $('#text-search-input').blur(function(){
        if($(this).val() == ''){
            $(this).val(SEARCH);
        }
    });

    $('.send-message-clickable').click(function(){

        if(USER_LOGGED){

            $('#message-send-popup-container').lightbox_me({
                centered: true,
                closeSelector: '.message-popup-cancel',
                onClose: function(){
                    $('#message-popup-msg').removeClass('write-invalid');
                    $('#message-popup-msg').val('');
                },
                onLoad:	function(){
                    $('#message-popup-msg').focus();
                }
            });

        }else{
            document.getElementById("message_not_logged_in_action").style.display="block";
            $('#register_form').lightbox_me({
                centered: true,
                closeSelector: '#close-register_form-required-popup',
                onClose: function(){
                    $('.register-form-error').hide();
                }
            });
        }

    });

    $("body").delegate('.applauses-clickable', 'click', function(){

        var text_id = $(this).data('textId');
        var text_title = $(this).data('textTitle');

        $.post(
            get_users_who_applauded_text_url,
            { text_id: text_id },
            function(data) {

                if(data.clapCount > 0){

                    if(data.clapCount > 1){
                        var clap = 'aplausos';
                    }
                    else{
                        var clap = 'aplauso';
                    }

                    var user_box_title = '<span class="bold italic">"'+text_title+'"</span> ha recibido <span class="bold">'+data.clapCount+' '+clap+'.</span>';
                    $('#user-box-title').html(user_box_title);
                    $('#user-box-title').attr('class', 'claps-users-title');
                    $('#user-list').html(data.usersHtml);

                    $('#user-box').lightbox_me({
                        centered: true,
                        closeSelector: '#user-box-close-icon',
                        onLoad: function(){
                            $('.user-box-name').dotdotdot({
                                wrap: 'letter'
                            });
                        }
                    });

                }

            }
            , "json"
        );

    });

    $("body").delegate('#message-popup-send-button', 'click', function(){

        if($(this).hasClass('disabled')){
            return false;
        }

        var message = $('#message-popup-msg').val();
        processSendMessageEvent2(writer_id, message);

    });

    $("body").delegate('#followers', 'click', function(){

        $.post(
            get_users_who_follow_me_url,
            {},
            function(data) {

                if(data.countUsers > 0){

                    if(data.countUsers > 1){
                        var user = 'usuarios';
                        var are = 'están';
                    }
                    else{
                        var user = 'usuario';
                        var are = 'está';
                    }

                    var user_box_title = 'Te '+are+' siguiendo <span class="bold">'+data.countUsers+' '+user+'.</span>';
                    $('#user-box-title').html(user_box_title);
                    $('#user-box-title').attr('class', 'followed-users-title');
                    $('#user-list').html(data.usersHtml);

                    $('#user-box').lightbox_me({
                        centered: true,
                        closeSelector: '#user-box-close-icon',
                        onLoad: function(){
                            $('.user-box-name').dotdotdot({
                                wrap: 'letter'
                            });
                        }
                    });

                }

            }
            , "json"
        );

    });
	
	
	$("body").delegate('#reestablish-password-button', 'click', function(e){
		if($(this).hasClass('disabled')){
		   return false;
		}
		$(this).addClass('disabled');		
	});
	

    $("body").delegate('#followeds', 'click', function(){

        $.post(
            get_users_who_i_am_following_url,
            {},
            function(data) {

                if(data.countUsers > 0){

                    if(data.countUsers > 1){
                        var user = 'usuarios';
                    }
                    else{
                        var user = 'usuario';
                    }

                    var user_box_title = 'Estás siguiendo a <span class="bold">'+data.countUsers+' '+user+'.</span>';
                    $('#user-box-title').html(user_box_title);
                    $('#user-box-title').attr('class', 'following-users-title');
                    $('#user-list').html(data.usersHtml);

                    $('#user-box').lightbox_me({
                        centered: true,
                        closeSelector: '#user-box-close-icon',
                        onLoad: function(){
                            $('.user-box-name').dotdotdot({
                                wrap: 'letter'
                            });
                        }
                    });

                }

            }
            , "json"
        );

    });

});






/*CALLBACK MESSAGES*/
function wrong_registration(texto,langg){		
	oXML = AJAXCrearObjeto();		
	var lang="en";
	if (langg){
		lang=langg;
	}
	oXML.open('GET', IROUTE+'/index.php?lang='+lang+'&option=com_users&controller=Ajax&no_html=1&task=wrong_registration');
	oXML.onreadystatechange = abt;
	oXML.send(' ');	
}
function success_registration(texto,langg){		
	oXML = AJAXCrearObjeto();		
	var lang="en";
	if (langg){
		lang=langg;
	}
    //oXML.open('GET', IROUTE+'/index.php?lang='+lang+'&option=com_users&controller=Ajax&no_html=1&task=success_registration');
	oXML.open('GET', base_url+'/index.php?lang='+lang+'&option=com_users&controller=Ajax&no_html=1&task=success_registration');
	oXML.onreadystatechange = abt;
	oXML.send(' ');	
}
function success_registration_pre(texto,langg){		
	oXML = AJAXCrearObjeto();		
	var lang="en";
	if (langg){
		lang=langg;
	}
	//oXML.open('GET', IROUTE+'/index.php?lang='+lang+'&option=com_users&controller=Ajax&no_html=1&task=success_registration_pre');
	oXML.open('GET', base_url+'/index.php?lang='+lang+'&option=com_users&controller=Ajax&no_html=1&task=success_registration_pre');
	oXML.onreadystatechange = abt;
	oXML.send(' ');	
}

function abt(){
	if (oXML.readyState  == 4) {
		var result = oXML.responseText;
			document.getElementById('ajax_messages').innerHTML = result;
			
			$('#ajax_messages').lightbox_me({
				centered: true,
				closeSelector: '#close-ajax_messages-required-popup'
			});		
		
	}
}

function forgot_confirm(texto,langg){		
	oXML = AJAXCrearObjeto();		
	var lang="en";
	if (langg){
		lang=langg;
	}
	oXML.open('GET', IROUTE+'/index.php?lang='+lang+'&option=com_users&controller=Ajax&no_html=1&task=forgot_confirm');
	oXML.onreadystatechange = abt;
	oXML.send(' ');	
}
function forgot_complete(texto,langg){		
	oXML = AJAXCrearObjeto();		
	var lang="en";
	if (langg){
		lang=langg;
	}
	oXML.open('GET', IROUTE+'/index.php?lang='+lang+'&option=com_users&controller=Ajax&no_html=1&task=forgot_complete');
	oXML.onreadystatechange = abt;
	oXML.send(' ');	
}
function forgot_success(texto,langg){		
	oXML = AJAXCrearObjeto();		
	var lang="en";
	if (langg){
		lang=langg;
	}
	oXML.open('GET', IROUTE+'/index.php?lang='+lang+'&option=com_users&controller=Ajax&no_html=1&task=forgot_success');
	oXML.onreadystatechange = abt;
	oXML.send(' ');	
}




function validateEmail(email) {
    var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    return re.test(email);
}

function removeTags(text){

    var txt = text.replace(/(<([^>]+)>)/ig,"");//Remueve los tags
    //txt = txt.replace(/ /g,\"\");//Remueve los espacios
    txt = txt.replace(/\n/gi,"");//Remueve los saltos de linea
    txt = $("<div/>").html(txt).text();

    return txt;
}

var Tools = {
    createCookie: function(name, value, days) {
        if (days) {
            var date = new Date();
            date.setTime(date.getTime()+(days*24*60*60*1000));
            var expires = "; expires="+date.toGMTString();
        }
        else{
            var expires = "";
        }
        document.cookie = name+"="+value+expires+"; path=/";
    },

    readCookie: function(name) {
        var nameEQ = name + "=";
        var ca = document.cookie.split(';');
        for(var i=0; i < ca.length; i++) {
            var c = ca[i];
            while (c.charAt(0)==' ') c = c.substring(1,c.length);
            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
        }
        return null;
    },

    eraseCookie: function(name) {
        Tools.createCookie(name,"",-1);
    }
};

/*REA CALLBACK MESSAGES*/